# –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firebase –¥–ª—è Tracker Costs

## üìã –ö–†–û–ö 1: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firestore Database

### 1.1 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Firebase Console](https://console.firebase.google.com/)
2. –í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—à –ø—Ä–æ–µ–∫—Ç (tracker_costs –∞–±–æ —è–∫ –≤–∏ –π–æ–≥–æ –Ω–∞–∑–≤–∞–ª–∏)
3. –£ –±–æ–∫–æ–≤–æ—ó –ø–∞–Ω–µ–ª—ñ –≤–∏–±–µ—Ä—ñ—Ç—å **Build** ‚Üí **Firestore Database**
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Create database**
5. –í–∏–±–µ—Ä—ñ—Ç—å —Ä–µ–∂–∏–º –∑–∞–ø—É—Å–∫—É:
   - **Start in test mode** (—Ç–∏–º—á–∞—Å–æ–≤–æ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏)
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Next**
6. –í–∏–±–µ—Ä—ñ—Ç—å —Ä–µ–≥—ñ–æ–Ω:
   - –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è: **europe-west1** (–ë–µ–ª—å–≥—ñ—è) –∞–±–æ **europe-central2** (–ü–æ–ª—å—â–∞)
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Enable**
7. –ó–∞—á–µ–∫–∞–π—Ç–µ –¥–æ–∫–∏ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è (1-2 —Ö–≤–∏–ª–∏–Ω–∏)

### 1.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–ª–µ–∫—Ü—ñ–π

–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, Firestore –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç—å –∫–æ–ª–µ–∫—Ü—ñ—ó –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –¥–∞–Ω–∏—Ö. –û—á—ñ–∫—É–≤–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

#### –ö–æ–ª–µ–∫—Ü—ñ—è: `expenses`
**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤–∏—Ç—Ä–∞—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

**–ü–æ–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**:
- `userId` (string) - ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–∑ Firebase Auth)
- `category` (string) - –ö–∞—Ç–µ–≥–æ—Ä—ñ—è –≤–∏—Ç—Ä–∞—Ç–∏ ("–á–∂–∞", "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", —Ç–æ—â–æ)
- `description` (string) - –û–ø–∏—Å –≤–∏—Ç—Ä–∞—Ç–∏
- `amount` (number) - –°—É–º–∞ –≤–∏—Ç—Ä–∞—Ç–∏
- `icon` (string) - –ï–º–æ–¥–∑—ñ —ñ–∫–æ–Ω–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
- `colorValue` (number) - –ö–æ–ª—ñ—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó (–∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —è–∫ int)
- `date` (timestamp) - –î–∞—Ç–∞ –≤–∏—Ç—Ä–∞—Ç–∏
- `receiptUrl` (string, optional) - URL —á–µ–∫–∞/—Ñ–æ—Ç–æ –∑ Firebase Storage
- `createdAt` (timestamp) - –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É
- `updatedAt` (timestamp) - –î–∞—Ç–∞ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

**–Ü–Ω–¥–µ–∫—Å–∏** (—Å—Ç–≤–æ—Ä—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ):
- –ö–æ–º–ø–æ–∑–∏—Ç–Ω–∏–π —ñ–Ω–¥–µ–∫—Å: `userId` (ASC) + `date` (DESC)
- –ö–æ–º–ø–æ–∑–∏—Ç–Ω–∏–π —ñ–Ω–¥–µ–∫—Å: `userId` (ASC) + `category` (ASC) + `date` (DESC)

#### –ö–æ–ª–µ–∫—Ü—ñ—è: `userSettings`
**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

**ID –¥–æ–∫—É–º–µ–Ω—Ç–∞**: –¥–æ—Ä—ñ–≤–Ω—é—î userId

**–ü–æ–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**:
- `userId` (string) - ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `monthlyBudget` (number) - –ú—ñ—Å—è—á–Ω–∏–π –±—é–¥–∂–µ—Ç (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 15000)
- `currency` (string) - –í–∞–ª—é—Ç–∞ ("UAH", "USD", "EUR")
- `defaultCategory` (string) - –ö–∞—Ç–µ–≥–æ—Ä—ñ—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º ("–á–∂–∞")
- `notificationsEnabled` (boolean) - –£–≤—ñ–º–∫–Ω—É—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è (true)
- `language` (string) - –ú–æ–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É ("uk")
- `isDarkMode` (boolean) - –¢–µ–º–Ω–∞ —Ç–µ–º–∞ (false)
- `createdAt` (timestamp) - –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
- `updatedAt` (timestamp) - –î–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

---

## üîê –ö–†–û–ö 2: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firestore Security Rules

### 2.1 –í—ñ–¥–∫—Ä–∏—Ç—Ç—è Rules

1. –£ Firestore Database –ø–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Rules**
2. –í–∏ –ø–æ–±–∞—á–∏—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø—Ä–∞–≤–∏–ª –±–µ–∑–ø–µ–∫–∏

### 2.2 –í—Å—Ç–∞–≤–∫–∞ –ø—Ä–∞–≤–∏–ª

–°–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `firestore.rules` –∑ –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ –≤—Å—Ç–∞–≤—Ç–µ –π–æ–≥–æ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä:

```javascript
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —á–∏ —Ü–µ –≤–ª–∞—Å–Ω–∏–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    function isOwner(userId) {
      return isAuthenticated() && request.auth.uid == userId;
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ–ª–µ–∫—Ü—ñ—ó –≤–∏—Ç—Ä–∞—Ç (expenses)
    match /expenses/{expenseId} {
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç
      allow read: if isAuthenticated() && 
                    resource.data.userId == request.auth.uid;
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –∑ –≤–ª–∞—Å–Ω–∏–º userId
      allow create: if isAuthenticated() && 
                     request.resource.data.userId == request.auth.uid &&
                     request.resource.data.keys().hasAll([
                       'userId', 'category', 'description', 
                       'amount', 'date', 'colorValue'
                     ]) &&
                     request.resource.data.amount is number &&
                     request.resource.data.amount > 0;
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç
      allow update: if isAuthenticated() && 
                     resource.data.userId == request.auth.uid &&
                     request.resource.data.userId == request.auth.uid;
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç
      allow delete: if isAuthenticated() && 
                     resource.data.userId == request.auth.uid;
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (userSettings)
    match /userSettings/{userId} {
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
      allow read: if isOwner(userId);
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
      allow create: if isOwner(userId) &&
                     request.resource.data.userId == userId;
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
      allow update: if isOwner(userId) &&
                     request.resource.data.userId == userId;
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
      allow delete: if isOwner(userId);
    }
    
    // –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—à–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ–π
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

### 2.3 –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø—Ä–∞–≤–∏–ª

1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Publish**
2. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø—É–±–ª—ñ–∫–∞—Ü—ñ—é
3. –ü—Ä–∞–≤–∏–ª–∞ –≤—Å—Ç—É–ø–ª—è—Ç—å —É –¥—ñ—é —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥

### 2.4 –ü–æ—è—Å–Ω–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª

**–ë–µ–∑–ø–µ–∫–∞ –≤–∏—Ç—Ä–∞—Ç (expenses)**:
- ‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å —á–∏—Ç–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏
- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏—Ç—Ä–∞—Ç–∏ –º–æ–∂–ª–∏–≤–µ —Ç—ñ–ª—å–∫–∏ –∑ userId –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —â–æ amount > 0
- ‚úÖ –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç

**–ë–µ–∑–ø–µ–∫–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å (userSettings)**:
- ‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ —á–∏—Ç–∞—Ç–∏/–∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- ‚úÖ ID –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ userId

---

## üìÅ –ö–†–û–ö 3: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firebase Storage

### 3.1 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ö–æ–≤–∏—â–∞

1. –£ –±–æ–∫–æ–≤–æ—ó –ø–∞–Ω–µ–ª—ñ –≤–∏–±–µ—Ä—ñ—Ç—å **Build** ‚Üí **Storage**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Get started**
3. –í–∏–±–µ—Ä—ñ—Ç—å **Start in test mode**
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Next**
5. –í–∏–±–µ—Ä—ñ—Ç—å —Ä–µ–≥—ñ–æ–Ω (—Ç–æ–π —Å–∞–º–∏–π —â–æ –¥–ª—è Firestore)
6. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Done**

### 3.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
storage/
‚îú‚îÄ‚îÄ receipts/
‚îÇ   ‚îî‚îÄ‚îÄ {userId}/
‚îÇ       ‚îî‚îÄ‚îÄ {expenseId}/
‚îÇ           ‚îî‚îÄ‚îÄ {timestamp}.jpg
‚îî‚îÄ‚îÄ avatars/
    ‚îî‚îÄ‚îÄ {userId}/
        ‚îî‚îÄ‚îÄ avatar.jpg
```

### 3.3 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Storage Rules

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Rules**
2. –°–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `storage.rules`:

```javascript
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —á–∏ —Ü–µ –≤–ª–∞—Å–Ω–∏–∫ —Ñ–∞–π–ª—É
    function isOwner(userId) {
      return isAuthenticated() && request.auth.uid == userId;
    }
    
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∏–ø—É —Ñ–∞–π–ª—É (—Ç—ñ–ª—å–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è)
    function isImage() {
      return request.resource.contentType.matches('image/.*');
    }
    
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–æ–∑–º—ñ—Ä—É —Ñ–∞–π–ª—É (–º–∞–∫—Å–∏–º—É–º 5 –ú–ë)
    function isValidSize() {
      return request.resource.size <= 5 * 1024 * 1024;
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è —á–µ–∫—ñ–≤ –≤–∏—Ç—Ä–∞—Ç (receipts)
    match /receipts/{userId}/{expenseId}/{fileName} {
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏–∫—É
      allow read: if isOwner(userId);
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å –¥–æ 5 –ú–ë
      allow write: if isOwner(userId) && 
                    isImage() && 
                    isValidSize();
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏–∫—É
      allow delete: if isOwner(userId);
    }
    
    // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
    match /avatars/{userId}/{fileName} {
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è –≤—Å—ñ–º –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º
      allow read: if isAuthenticated();
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏–∫—É
      allow write: if isOwner(userId) && 
                    isImage() && 
                    isValidSize();
      
      // –î–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏–∫—É
      allow delete: if isOwner(userId);
    }
    
    // –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—à–∏—Ö —à–ª—è—Ö—ñ–≤
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
```

3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Publish**

### 3.4 –ü–æ—è—Å–Ω–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª Storage

**–ë–µ–∑–ø–µ–∫–∞ —á–µ–∫—ñ–≤ (receipts)**:
- ‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –¥–æ —Å–≤–æ—î—ó –ø–∞–ø–∫–∏
- ‚úÖ –î–æ–∑–≤–æ–ª–µ–Ω—ñ —Ç—ñ–ª—å–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (image/*)
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä 5 –ú–ë
- ‚úÖ –ß–∏—Ç–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤

**–ë–µ–∑–ø–µ–∫–∞ –∞–≤–∞—Ç–∞—Ä—ñ–≤ (avatars)**:
- ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ —É —Å–≤–æ—é –ø–∞–ø–∫—É
- ‚úÖ –í—Å—ñ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å —á–∏—Ç–∞—Ç–∏ –∞–≤–∞—Ç–∞—Ä–∏ —ñ–Ω—à–∏—Ö

---

## ‚úÖ –ö–†–û–ö 4: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

### 4.1 –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Firestore

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫
2. –£–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ email –∞–±–æ Google
3. –î–æ–¥–∞–π—Ç–µ –≤–∏—Ç—Ä–∞—Ç—É
4. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ Firebase Console ‚Üí Firestore Database
5. –ü–æ–≤–∏–Ω–Ω–∞ –∑'—è–≤–∏—Ç–∏—Å—è –∫–æ–ª–µ–∫—Ü—ñ—è `expenses` –∑ –≤–∞—à–∏–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–º

### 4.2 –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Storage (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

1. –†–µ–∞–ª—ñ–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —á–µ–∫–∞ –≤ AddExpenseScreen
2. –í–∏–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ image_picker
3. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —á–µ—Ä–µ–∑ StorageRepository
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤ Firebase Console ‚Üí Storage

### 4.3 –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Security Rules

–í Firebase Console ‚Üí Firestore Database ‚Üí Rules:
```
‚úÖ Last publish: [–¥–∞—Ç–∞] by [–≤–∞—à email]
```

---

## üìä –ö–†–û–ö 5: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 5.1 Dashboard

1. Firestore Dashboard –ø–æ–∫–∞–∑—É—î:
   - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
   - –ö—ñ–ª—å–∫—ñ—Å—Ç—å —á–∏—Ç–∞–Ω—å/–∑–∞–ø–∏—Å—ñ–≤
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ö–æ–≤–∏—â–∞

### 5.2 –õ—ñ–º—ñ—Ç–∏ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ–≥–æ –ø–ª–∞–Ω—É Spark

- **Firestore**: 1 –ì–ë —Å—Ö–æ–≤–∏—â–∞, 50,000 —á–∏—Ç–∞–Ω—å/–¥–µ–Ω—å, 20,000 –∑–∞–ø–∏—Å—ñ–≤/–¥–µ–Ω—å
- **Storage**: 5 –ì–ë —Å—Ö–æ–≤–∏—â–∞, 1 –ì–ë –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å/–¥–µ–Ω—å
- **Authentication**: –ù–µ–æ–±–º–µ–∂–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

---

## üöÄ –ö–†–û–ö 6: –ó–∞–ø—É—Å–∫ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É

–ü—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firebase Console:

```bash
# –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ –≤—Å—ñ –ø–∞–∫–µ—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ
flutter pub get

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫
flutter run
```

### –û—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞:

1. **–ü—ñ—Å–ª—è –≤—Ö–æ–¥—É**:
   - FirestoreExpensesProvider —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è
   - UserSettingsProvider –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–∞–±–æ —Å—Ç–≤–æ—Ä—é—î –¥–µ—Ñ–æ–ª—Ç–Ω—ñ)
   - –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ real-time –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∞

2. **–î–æ–¥–∞–≤–∞–Ω–Ω—è –≤–∏—Ç—Ä–∞—Ç–∏**:
   - –í–∏—Ç—Ä–∞—Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ Firestore
   - UI –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ Stream
   - –í–∏—Ç—Ä–∞—Ç–∞ –∑'—è–≤–ª—è—î—Ç—å—Å—è –Ω–∞ –≤—Å—ñ—Ö –µ–∫—Ä–∞–Ω–∞—Ö

3. **–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è/–≤–∏–¥–∞–ª–µ–Ω–Ω—è**:
   - –ó–º—ñ–Ω–∏ –º–∏—Ç—Ç—î–≤–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è
   - –î–∞–Ω—ñ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω—ñ –Ω–∞ –≤—Å—ñ—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

---

## üîç –ö–†–û–ö 7: –ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü–æ–º–∏–ª–∫–∞: "PERMISSION_DENIED"

**–ü—Ä–∏—á–∏–Ω–∞**: Security Rules –±–ª–æ–∫—É—é—Ç—å –¥–æ—Å—Ç—É–ø

**–†—ñ—à–µ–Ω–Ω—è**:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–≤—ñ–π—à–æ–≤ (userId –Ω–µ null)
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –≤–∏—Ç—Ä–∞—Ç–∞ –º–∞—î –ø–æ–ª–µ userId
3. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ Firebase Console

### –ü–æ–º–∏–ª–∫–∞: "Missing required field"

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ –≤—Å—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ

**–†—ñ—à–µ–Ω–Ω—è**:
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ Expense –º–∞—î –≤—Å—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è
- userId, category, description, amount, date, colorValue

### –í–∏—Ç—Ä–∞—Ç–∏ –Ω–µ –∑'—è–≤–ª—è—é—Ç—å—Å—è

**–ü—Ä–∏—á–∏–Ω–∞**: –°—Ç—Ä—ñ–º –Ω–µ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π –∞–±–æ –ø–æ–º–∏–ª–∫–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó

**–†—ñ—à–µ–Ω–Ω—è**:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ FirestoreExpensesProvider.initializeExpenses() –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ userId –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π
3. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ª–æ–≥–∏ –≤ Debug Console

---

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É –ø—ñ—Å–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

```
lib/
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ expense.dart              # –ú–æ–¥–µ–ª—å –∑ toFirestore/fromFirestore
‚îÇ   ‚îî‚îÄ‚îÄ user_settings.dart        # –ú–æ–¥–µ–ª—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îú‚îÄ‚îÄ expenses_repository.dart  # –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å + Firestore —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ user_settings_repository.dart
‚îÇ   ‚îú‚îÄ‚îÄ storage_repository.dart   # Firebase Storage
‚îÇ   ‚îî‚îÄ‚îÄ auth_repository.dart      # Firebase Auth
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ firestore_expenses_provider.dart  # –ù–æ–≤–∏–π Provider –∑ Firestore
‚îÇ   ‚îú‚îÄ‚îÄ user_settings_provider.dart       # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îî‚îÄ‚îÄ expenses_provider.dart    # –°—Ç–∞—Ä–∏–π (mock data) - –º–æ–∂–Ω–∞ –≤–∏–¥–∞–ª–∏—Ç–∏
‚îú‚îÄ‚îÄ screens/
‚îÇ   ‚îú‚îÄ‚îÄ home_screen.dart          # –û–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è FirestoreExpensesProvider
‚îÇ   ‚îú‚îÄ‚îÄ add_expense_screen.dart   # –û–Ω–æ–≤–ª–µ–Ω–æ
‚îÇ   ‚îú‚îÄ‚îÄ expenses_screen.dart      # –û–Ω–æ–≤–ª–µ–Ω–æ
‚îÇ   ‚îú‚îÄ‚îÄ expense_detail_screen.dart
‚îÇ   ‚îî‚îÄ‚îÄ category_expenses_screen.dart
‚îú‚îÄ‚îÄ main.dart                     # MultiProvider –∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è–º–∏
‚îú‚îÄ‚îÄ firestore.rules               # –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏ Firestore
‚îî‚îÄ‚îÄ storage.rules                 # –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏ Storage
```

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ —Ç–µ–ø–µ—Ä –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∏–π –∑ Firebase Firestore —Ç–∞ Storage!

**–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ**:
- ‚úÖ Real-time —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –≤–∏—Ç—Ä–∞—Ç
- ‚úÖ –ë–∞–≥–∞—Ç–æ–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –∑ –≤–ª–∞—Å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏
- ‚úÖ –ë–µ–∑–ø–µ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ Security Rules
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —á–µ–∫—ñ–≤/—Ñ–æ—Ç–æ –≤ Storage
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –≤ Firestore
- ‚úÖ Provider state management –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º UI
